<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>注册</title>
    <script src="../js/jquery-3.5.1.min.js"></script>
    <script src="../js/jquery.cookie.js"></script>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.css">
    <style>
        body{
            position: relative;
            background-image: url("../image/qq/a2.jpg");
            background-repeat: no-repeat;
            background-size: 100% 721px;
        }
        .main{
            position: absolute;
            top: 20px;
            width: 433px;
            height: 650px;
            left: 50%;
            margin-left: -15%;
            border: solid 1px;
            border-radius: 1.2%;
            overflow: hidden;
        }
        .main h2{
            text-align: center;
            background-image: url("../image/qq/background.png");
            background-repeat: no-repeat;
        }
        button{
            position: absolute;
            left: 40%;
            margin-left: -8%;
        }
        .form-control{
            !important;
            opacity:0.79;
            color: #101212;
        }
        .btn-info{
            width: 151px;
        }
    </style>
</head>
<body>
<div class="main">
    <h2>欢迎注册</h2>
    <div>

            <div class="form-group">
                <input type="text" class="form-control" id="name" placeholder="请输入昵称">
            </div>
            <div class="form-group">
                <input type="text" class="form-control" id="age" placeholder="请输入年龄">
            </div>
            <div class="form-group">
                性别：<select class="form-control" id="sex">
                <option value="1">男</option>
                <option value="2">女</option>
                <option value="3">外星人</option>
            </select>
            </div>
            <div class="form-group">
               <input type="password" class="form-control" id="password1" placeholder="请输入密码">
            </div>
            <div class="form-group">
                <input type="password" class="form-control" id="password" placeholder="请再次输入密码">
            </div>
            <div class="form-group">
               <input type="text" class="form-control" id="username" placeholder="请输入姓名">
            </div>
            <div class="form-group">
                星座：<select class="form-control" id="xz">
                <option value="1">白羊</option>
                <option value="2">金牛</option>
                <option value="3">双子</option>
                <option value="4">巨蟹</option>
                <option value="5">狮子</option>
                <option value="6">处女</option>
                <option value="7">天秤</option>
                <option value="8">天蝎</option>
                <option value="9">射手</option>
                <option value="10">摩羯</option>
                <option value="11">水瓶</option>
                <option value="12">双鱼</option>
            </select>
            </div>
            <div class="form-group">
                血型：<select class="form-control" id="xuex">
                <option value="1">A</option>
                <option value="2">B</option>
                <option value="3">AB</option>
                <option value="4">O</option>
                <option value="5">熊猫</option>
            </select>
            </div>
        <div class="form-group">
            <input type="text" class="form-control" id="mibao" placeholder="请输入密保">
        </div>
            <button id="registered" type="submit" class="btn btn-info">注册</button>

    </div>
</div>
<script>
    $("#name").blur(function () {
        var name = $("#name").val();
        $.ajax({
            url:'../ecq',
            method:'post',
            dataType:'Json',
            data:{
                name:name
            },
            success: function (data) {
                if(data.flag == false){
                    alert(data.errorMsg);
                    $("#name").val("");
                }
            }
        });
    });
    function checkUsername() {
        //1.获取用户名值
        var username = $("#name").val();
        //2.定义正则
        var reg_username = /^\w{4,20}$/;

        //3.判断，给出提示信息
        var flag = reg_username.test(username);
        if (flag) {
            //用户名合法
            $("#name").css("border", "");
        } else {
            //用户名非法,加一个红色边框
            $("#name").css("border", "1px solid red");
            alert("昵称不能为空");
        }
        return flag;
    }
        function checkAge() {
            //1.获取用户名值
            var username = $("#age").val();
            //2.定义正则
            var reg_username = /^\w{1,3}$/;

            //3.判断，给出提示信息
            var flag = reg_username.test(username);
            if (flag) {
                //用户名合法
                $("#age").css("border", "");
            } else {
                //用户名非法,加一个红色边框
                $("#age").css("border", "1px solid red");
                alert("年龄不能为空")
            }
            return flag;
    }
            //校验密码
            function checkPassword() {
                //1.获取密码值
                var password = $("#password").val();
                //2.定义正则
                var reg_password = /^\w{4,20}$/;

                //3.判断，给出提示信息
                var flag = reg_password.test(password);
                if(flag){
                    //密码合法
                    $("#password").css("border","");
                }else{
                    //密码非法,加一个红色边框
                    $("#password").css("border","1px solid red");
                    alert("密码不能为空")
                }

                return flag;
            }
            //校验密码
            function checkPassword1() {
                //1.获取密码值
                var password = $("#password1").val();
                //2.定义正则
                var reg_password = /^\w{4,20}$/;

                //3.判断，给出提示信息
                var flag = reg_password.test(password);
                if(flag){
                    //密码合法
                    $("#password1").css("border","");
                }else{
                    //密码非法,加一个红色边框
                    $("#password1").css("border","1px solid red");
                    alert("密码不能为空")
                }

                return flag;
            }
            function ifPassword() {
                var val = $("#password").val();
                var val1 = $("#password1").val();
                if(val != val1){
                    $("#password").css("border","1px solid red");
                    $("#password1").css("border","1px solid red");
                    alert("两次密码不一样");
                }else {
                    $("#password").css("border","");
                    $("#password1").css("border","");
                }
            }
    function checkName() {
        //1.获取用户名值
        var username = $("#username").val();
        //2.定义正则
        var reg_username = /^\w{1,10}$/;

        //3.判断，给出提示信息
        var flag = reg_username.test(username);
        if (flag) {
            //用户名合法
            $("#username").css("border", "");
        } else {
            //用户名非法,加一个红色边框
            $("#username").css("border", "1px solid red");
            alert("姓名不能为空")
        }
        return flag;
    }

        $("#registered").click(function () {
        $.ajax({
            url:'/ecqUsersServlet',
            method: 'post',
            dataType:'Json',
            data:{
                name:$("#name").val(),
                age:$("#age").val(),
                sex:$("#sex").val(),
                password:$("#password").val(),
                username:$("#username").val(),
                xz:$("#xz").val(),
                xuex:$("#xuex").val(),
                mibao:$("#mibao").val()
            },
            success:function (data) {
                if(data.flag == true){
                    alert(data.errorMsg);
                    window.location.href="login.html";
                } else {
                    alert(data.errorMsg)
                }
            }
        })
            if((checkUsername()&&checkAge()&&checkPassword()&&checkPassword1()&&ifPassword()&&checkName())!=true) {
                $("#username").blur(checkName);
                $("#age").blur(checkAge);
                $("#password").blur(checkPassword);
                $("#password1").blur(checkPassword1);
                $("#password").blur(ifPassword);
                $("#name").blur(checkUsername);
            }
        })
</script>
</body>
</html>